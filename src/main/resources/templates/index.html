<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/layout :: header (pageTitle='主页')">
    <!-- META SECTION -->
    <title>Joli Admin - Responsive Bootstrap Admin Template</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <link rel="icon" href="favicon.ico" type="image/x-icon"/>
    <!-- END META SECTION -->

    <!-- CSS INCLUDE -->
    <link rel="stylesheet" type="text/css" id="theme" href="css/theme-default.css"/>
    <!-- EOF CSS INCLUDE -->
</head>
<body>
<!-- START PAGE CONTAINER -->
<div class="page-container page-navigation-top-fixed">

    <!-- START PAGE SIDEBAR -->
    <div th:include="fragments/layout :: sideBar" th:remove="tag"></div>
    <!-- END PAGE SIDEBAR -->

    <!-- PAGE CONTENT -->
    <div class="page-content">

        <!-- START X-NAVIGATION VERTICAL -->
        <div th:include="fragments/layout :: contentTop" th:remove="tag"></div>
        <!-- END X-NAVIGATION VERTICAL -->


        <div class="page-title">
            <h2><span class="fa fa-search"></span> 职业 查找 </h2>
        </div>

        <!-- PAGE CONTENT WRAPPER -->
        <div class="page-content-wrap">
            <div class="row">
                <div class="col-md-3 col-md-offset-1">

                    <!-- START WIDGET SLIDER -->
                    <div class="widget widget-default widget-carousel">
                        <div class="owl-carousel" id="owl-example">
                            <div>
                                <div class="widget-title">收录</div>
                                <div class="widget-subtitle">职位</div>
                                <div class="widget-int">1,977</div>
                            </div>
                            <div>
                                <div class="widget-title">总访问量</div>
                                <div class="widget-subtitle">27/08/2014 15:23</div>
                                <div class="widget-int">3,548</div>
                            </div>


                        </div>
                        <div class="widget-controls">
                            <a href="#" class="widget-control-right widget-remove" data-toggle="tooltip"
                               data-placement="top" title="Remove Widget"><span class="fa fa-times"></span></a>
                        </div>
                    </div>
                    <!-- END WIDGET SLIDER -->

                </div>


                <div class="col-md-4">

                    <!-- START WIDGET CLOCK -->
                    <div class="widget widget-info widget-padding-sm">
                        <div class="widget-big-int plugin-clock">00:00</div>
                        <div class="widget-subtitle plugin-date">Loading...</div>
                        <div class="widget-controls">
                            <a href="#" class="widget-control-right widget-remove" data-toggle="tooltip"
                               data-placement="left" title="Remove Widget"><span class="fa fa-times"></span></a>
                        </div>
                        <div class="widget-buttons widget-c3">
                            <div class="col">
                                <a href="#"><span class="fa fa-clock-o"></span></a>
                            </div>
                            <div class="col">
                                <a href="#"><span class="fa fa-bell"></span></a>
                            </div>
                            <div class="col">
                                <a href="#"><span class="fa fa-calendar"></span></a>
                            </div>
                        </div>
                    </div>
                    <!-- END WIDGET CLOCK -->

                </div>
                <div class="col-md-3">

                    <!-- START WIDGET MESSAGES -->
                    <div class="widget widget-default widget-item-icon"
                         onclick="location.href='/shortMessage/messagePage';">
                        <div class="widget-item-left">
                            <span class="fa fa-envelope"></span>
                        </div>
                        <div class="widget-data">
                            <div class="widget-int num-count">48</div>
                            <div class="widget-title">新私信</div>
                            <div class="widget-subtitle">职位推送:2</div>
                        </div>
                        <div class="widget-controls">
                            <a href="#" class="widget-control-right widget-remove" data-toggle="tooltip"
                               data-placement="top" title="Remove Widget"><span class="fa fa-times"></span></a>
                        </div>
                    </div>
                    <!-- END WIDGET MESSAGES -->

                </div>
            </div>
            <div class="row">
                <div class="col-md-1"></div>
                <div class="col-md-10">
                    <div class="panel panel-default">
                        <div class="panel-body">
                            <h4>建议应届毕业生按专业进行查找，其他人士直接进行检索</h4>
                            <form class="form-horizontal">
                                <div class="form-group">
                                    <div class="col-md-6">
                                        <button onclick="displayFindByMajor()" type="button"
                                                class="btn btn-primary btn-block"><span class="fa fa-search"></span>
                                            按专业查找
                                        </button>
                                    </div>
                                    <div class="col-md-6">
                                        <button type="button" class="btn btn-primary btn-block"><span
                                                class="fa fa-search"></span> 直接查找
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div id="findByMajor" class="panel panel-default" style="display: none;">
                        <div class="panel-body" id="majorPane" style="max-height: 400px;overflow-y:auto;">

                        </div>
                    </div>
                    <div id="searchBox" class="panel panel-default container">
                        <form id="jobSearchBox">
                        <div class="row stacked panel-body">
                            <div class="col-md-2"></div>

                            <div class="col-md-8">
                                <div class="text-center">
                                    <label class="control-label " for="keywords"><h2>易职搜</h2></label>
                                    <input id="keywords" name="keywords" type="text" class="tagsinput" value=""/>
                                </div>
                            </div>
                            <div class="col-md-2">


                            </div>
                        </div>
                            <div class="row stacked panel-body">
                                <div class="col-md-2"></div>
                                <div class="col-md-2">
                                    <div class="input-group push-down-10">
                                        <label class="control-label" for="study">学历要求</label>
                                        <select class='form-control select bootstrap-select' name='study' id="study">
                                            <option value='不限'>不限</option>
                                            <option value='专科及以上'>专科及以上</option>
                                            <option value='本科及以上'>本科及以上</option>
                                            <option value='硕士生及以上'>硕士生及以上</option>
                                            <option value='博士生及以上'>博士生及以上</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-2"></div>
                                <div class="col-md-6">
                                    <div class=" push-down-10">

                                        <label class=" control-label" for="place">工作地点要求</label>
                                        <div class="row">
                                            <div class="col-md-3">
                                                <select id="place" class='form-control select bootstrap-select' name='workPlace'>
                                                    <option value='不限'>不限</option>
                                                    <option value='专科及以上'>深圳</option>
                                                    <option value='本科及以上'>珠海</option>
                                                    <option value='硕士生及以上'>**</option>
                                                    <option value='博士生及以上'></option>
                                                </select>
                                            </div>
                                            <div class="col-md-4"></div>
                                            <button class='btn' onclick='search()' type='button'>搜索</button>
                                        </div>
                                    </div>
                                </div>


                        </div>
                        </form>
                    </div>
                    <div id="resultDisplayDiv" class="search-results">

                        <div class="sr-item">
                            <div class="col-md-2"></div>
                            <div class="col-md-8">
                                <a href="#" class="sr-item-title">百度</a>
                                <div class="sr-item-link">http://themifycloud.com/downloads/free-responsive-bootstrap-joli-angular-js-admin-template-dashboard-web-app/</div>
                                <div class="row">
                                    <div class="row">
                                        <div>公司</div>
                                    </div>
                                    <div class="row">
                                        <p style="padding-left:0px" class="col-md-3">年薪</p>
                                        <p class="col-md-3">工作地点</p>
                                    </div>
                                    <div class="row">
                                        <div style="padding-left:0px" class="col-md-3">学历</div>
                                        <div class="col-md-3">经验</div>
                                    </div>
                                </div>
                                <p class="sr-item-links"><a href="#">Translate this page</a> - <a href="#">View cache</a> - <a href="#">Remove from search</a></p>
                            </div>

                            <div class="col-md-2"></div>
                        </div>
                        <div class="panel panel-default">
                            <div class="panel-heading ui-draggable-handle">
                                <h2 class="panel-title">百度</h2>
                            </div>
                            <div class="panel-body">
                                <div class="row">
                                    <div class="col-md-8">
                                        <div class="row">
                                            <div class="col-md-6">年薪</div>
                                            <div class="col-md-6">工作地点</div>

                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">学历</div>
                                            <div class="col-md-6">经验</div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="row">
                                            <div class="col-md-4">公司</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--<div class="panel panel-default">-->
                            <!--<div class="panel-heading ui-draggable-handle">-->
                                <!--<h2 class="panel-title">啦啦啦</h2>-->
                            <!--</div>-->
                            <!--<div class="panel-body">-->
                                <!--<div class="row">-->
                                    <!--<div class="col-md-8">-->
                                        <!--<div class="row">-->
                                            <!--<div class="col-md-3">年薪</div>-->
                                            <!--<div class="col-md-3">工作地点</div>-->
                                            <!--<div class="col-md-3">学历</div>-->
                                            <!--<div class="col-md-3">经验</div>-->
                                        <!--</div>-->
                                    <!--</div>-->
                                    <!--<div class="col-md-4">-->
                                        <!--<h2>公司名</h2>-->
                                    <!--</div>-->
                                <!--</div>-->

                            <!--</div>-->
                        <!--</div>-->
                    </div>
                </div>
                <div class="col-md-1"></div>
            </div>

        </div>
        <!-- END PAGE CONTENT WRAPPER -->
    </div>
    <!-- END PAGE CONTENT -->
</div>
<!-- END PAGE CONTAINER -->

<div th:include="fragments/layout :: messageBox" th:remove="tag">

</div>


<!-- START SCRIPTS -->
<div th:include="fragments/layout :: allHasJs" th:remove="tag">

</div>

<!-- START THIS PAGE PLUGINS-->
<script type='text/javascript' src='/js/plugins/icheck/icheck.min.js'></script>
<script type="text/javascript" src="/js/plugins/mcustomscrollbar/jquery.mCustomScrollbar.min.js"></script>
<script type="text/javascript" src="/js/plugins/scrolltotop/scrolltopcontrol.js"></script>

<script type="text/javascript" src="/js/plugins/morris/raphael-min.js"></script>
<script type="text/javascript" src="/js/plugins/morris/morris.min.js"></script>
<script type="text/javascript" src="/js/plugins/rickshaw/d3.v3.js"></script>
<script type="text/javascript" src="/js/plugins/rickshaw/rickshaw.min.js"></script>
<script type='text/javascript' src='/js/plugins/jvectormap/jquery-jvectormap-1.2.2.min.js'></script>
<script type='text/javascript' src='/js/plugins/jvectormap/jquery-jvectormap-world-mill-en.js'></script>
<script type='text/javascript' src='/js/plugins/bootstrap/bootstrap-datepicker.js'></script>
<script type='text/javascript' src='/js/plugins/bootstrap/bootstrap-select.js'></script>
<script type="text/javascript" src="/js/plugins/owl/owl.carousel.min.js"></script>

<script type="text/javascript" src="/js/plugins/moment.min.js"></script>
<script type="text/javascript" src="/js/plugins/daterangepicker/daterangepicker.js"></script>
<script type="text/javascript" src="/js/plugins/jquery/jquery.tagsinput.min.js"></script>
<script type="text/javascript" src="/js/bdssite/search_module.js"></script>
<!-- END THIS PAGE PLUGINS-->

<!-- START TEMPLATE -->
<div th:include="fragments/layout :: templateJs" th:remove="tag">

</div>

<script>
    function displayFindByMajor() {
        majorChooserInit();
    }

    function majorChooserInit() {
        $('#findByMajor').hide();
        ajaxDataDisplay(null, "majorChildDisplay");
    }

    function majorChildDisplay(majorParentId) {
        ajaxDataDisplay(majorParentId, "subjectChoose");
    }

    function ajaxDataDisplay(majorParentId, functionName) {
        var majorDiv = $('#majorPane');
        $('#findByMajor').fadeOut(500, function () {
            majorDiv.html("");
            $.ajax({
                url: "/searchApi/majors",
                type: 'POST',
                data: majorParentId ? {'parentId': majorParentId} : {},
                success: function (data) {
                    var list = data['entityList'];
                    var num = list.length;
                    var buttonDom = [];
                    var moreRow = num % 6;
                    var defaultRow = Math.floor(num / 6);
                    $.each(list, function () {
                        buttonDom.push($("<button type=\"button\" onclick='" + functionName + "(" + this['id'] + ")' class=\"btn btn-primary btn-block\"><span class=\"fa fa-book\"></span> " + this['name'] + "</button>"));
                    });
                    for (var i = 0; i < 6; i++) {
                        var temp = $("<div class=\"col-md-2\"></div>");
                        for (var j = 0; j < (i < moreRow ? defaultRow + 1 : defaultRow ); j++) {
                            temp.append(buttonDom.pop());
                        }
                        majorDiv.append(temp);
                    }
                    $('#findByMajor').fadeIn(500);
                },
                error: function (e) {
                    alert("获取专业列表失败.")
                }

            });
        });
    }

    function subjectChoose(majorId) {
        var majorDiv = $('#majorPane');
        $('#findByMajor').fadeOut(500, function () {
            majorDiv.html("");
            $.ajax({
                url: "/searchApi/subject/byMajor",
                type: 'POST',
                data: {'majorId': majorId},
                success: function (data) {
                    var list = data['entityList'];
                    var num = list.length;
                    var buttonDom = [];
                    var moreRow = num % 6;
                    var defaultRow = Math.floor(num / 6);
                    $.each(list, function () {
                        buttonDom.push($("<button type=\"button\" data-value='" + this['name'] + "' onclick='this.remove()' class=\"btn btn-primary btn-block\"><span class=\"fa fa-minus\"></span> " + this['name'] + "</button>"));
                    });
                    majorDiv.append($("<p>请按实际情况划去关键词</p>"));
                    for (var i = 0; i < 6; i++) {
                        var temp = $("<div class=\"col-md-2\"></div>");
                        for (var j = 0; j < (i < moreRow ? defaultRow + 1 : defaultRow ); j++) {
                            temp.append(buttonDom.pop());
                        }
                        majorDiv.append(temp);
                    }
                    majorDiv.append("<button onclick=\'searchBox()\'>搜索</button>");
                    $('#findByMajor').fadeIn(500);
                },
                error: function () {
                    alert("获取专业列表失败.");
                }

            });
        });
    }

    function searchBox(words) {
        var keyButton = $("button[data-value]");
        var keyWords = "";
        if (keyButton.length > 0) {
            keyButton.each(function (index, element) {
                keyWords += element.getAttribute("data-value") + ",";
            });
            $("#keywords").val(keyWords);
        }
        $("#keywords_tagsinput").remove();
        $("#keywords").tagsInput();
        $("#majorPane").hide(600);
    }

    function search() {
        $.ajax({url:"/searchApi/search",
            type:'GET',
            data:$("#jobSearchBox").serialize(),
            dataType: "json",
            success:function (data) {
                $("#resultDisplayDiv").html("");
                $(data.response.docs).each(function (i, val) {
                    $("#resultDisplayDiv").append(generResultDiv(val));
                })
            }
        });
    }
    function generResultDiv(jobObj) {
        var html = [];
        html.push('<div class="sr-item">');
        html.push('<div class="col-md-2">');
        html.push('</div>');
        html.push('<div class="col-md-8">');
        html.push('<a href="'+jobObj['url']+'" class="sr-item-title">职位：');
        html.push(jobObj['job_name'][0]);
        html.push('</a>');

        html.push('<div class="row">');
        html.push('<div class="row">');
        html.push('<p>公司：');
        html.push(jobObj["job_company"][0]);
        html.push('</p>');
        html.push('</div>');
        html.push('<div class="row">');
        html.push('<p style="padding-left:0px" class="col-md-3">年薪：');
        if(jobObj["job_negotiation"][0] == "false"){
            if(jobObj["job_l_highest"] != jobObj["job_l_lowest"]){
                html.push(jobObj["job_l_lowest"]/10000.0);
                html.push("-");
                html.push(jobObj["job_l_highest"]/10000.0);
            }else{
                html.push(jobObj["job_l_lowest"]/10000.0);
            }
            html.push("万元/年");
        }else {
            html.push("面议");
        }
        html.push('</p>');
        html.push('<p class="col-md-3">工作地点：');
        html.push(jobObj["job_place"][0]);
        html.push('</p>');
        html.push('<div class="row">');
        html.push('<p style="padding-left:0px" class="col-md-3">学历：');
        html.push(jobObj["job_study"][0]);
        html.push('</p>');
        html.push('<p class="col-md-3">经验：' + jobObj["job_experience"][0] + '</p>');
        html.push('</div>');
        html.push('</div>');
        html.push('<a href="'+jobObj['url']+'" class="sr-item-link">');
        html.push(jobObj['url']);
        html.push('</a>');
        html.push('<p class="sr-item-links"><a href="'+jobObj['url']+'">Into this page</a> - <a href="'+jobObj['url']+'">View cache</a></p>');
        html.push('</div>');
        return html.join("");
    }
</script>
<!-- END TEMPLATE -->
<!-- END SCRIPTS -->
</body>
</html>






